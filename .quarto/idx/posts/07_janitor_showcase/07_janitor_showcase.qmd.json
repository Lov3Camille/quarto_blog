{"title":"Showcasing the janitor package","markdown":{"yaml":{"title":"Showcasing the janitor package","date":"2022-01-12","categories":[],"description":"I demonstrate a couple of functions from the janitor package I find quite useful","execute":{"message":false,"warning":false,"collapse":false},"editor_options":{"chunk_output_type":"console"}},"headingText":"| echo: false","containsRefs":false,"markdown":"\n\n```{r}\n#| results: 'hide'\nrenv::use(lockfile = \"renv.lock\")\n```\n\nThe `janitor` package contains only a little number of functions but nevertheless\nit is surprisingly convenient.\nI never really fully appreciated its functionality until I took a look into the documentation.\nOf course, other packages can achieve the same thing too but `janitor` makes\na lot of tasks easy.\nThus, here is a little showcase.\nIf you prefer a video version, you can find this blog post on [YouTube](https://youtu.be/AKPvlNWZBEQ).\n\n## Clean column names\n\nAs everyone working with data knows, data sets rarely come in a clean format.\nOften, the necessary cleaning process already starts with the column names.\nHere, take this data set from TidyTuesday, week 41.\n\n```{r}\n#| message = FALSE\nnurses <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-10-05/nurses.csv')\nnames(nurses)\n```\n\nThese column names are intuitively easy to understand but not necessarily easy to process\nby code as there are white spaces and other special characters.\nTherefore, I accompany most data input by `clean_names()` from the `janitor` package.\n\n```{r, message=F, warning=F}\nlibrary(janitor)\nlibrary(dplyr) # load for pipe %>%  and later wrangling\nnames(nurses %>% clean_names)\n```\n\nDid you see what happened?\nWhite spaces were converted to `_` and parantheses were removed.\nEven the `%` signs were converted to `percent`.\nNow, these labels are easy to understand AND process by code.\nThis does not mean that you are finished cleaning but at least now the columns\nare more accessible.\n\n## Remove empty and or constant columns and rows\n\nData sets come with empty or superfluous rows or columns are not a rare sighting. \nThis is especially true if you work with Excel files because there will be a lot of empty\ncells.\nTake a look at the dirty Excel data set from janitor's [GitHub page](https://github.com/sfirke/janitor/blob/main/dirty_data.xlsx).\nIt looks like this when you open it with Excel.\n\n```{r}\n#| echo = F\nknitr::include_graphics('dirty_data.PNG')\n```\n\nTaking a look just at this picture we may notice a couple of things.\n\n- First, [Jason Bourne](https://en.wikipedia.org/wiki/Jason_Bourne) is teaching at a school. \nI guess being a trained assassin qualifies him to teach physical education.\nAlso - and this is just a hunch - undercover work likely earned him his \"Theater\" certification.\n\n- Second, the header above the actual table will be annoying, so we must skip the first line\nwhen we read the data set.\n\n- Third, the column names are not ideal but we know how to deal with that by now.\n\n- Fourth, there are empty rows and columns we can get rid of.\n\n- Fifth, there is a column that contains only 'YES'.\nTherefore it contains no information at all and can be removed.\n\nSo, let us read and clean the data.\nThe `janitor` package will help us with `remove_empty()` and `remove_constant()`.\n\n```{r}\n#| message = F,\n#| warning = F\nxl_file <- readxl::read_excel('dirty_data.xlsx', skip = 1) %>% \n  clean_names() %>%\n  remove_empty() %>% \n  remove_constant()\nxl_file\n```\n\nHere, `remove_empty()` defaulted to remove, both, rows and colums.\nIf we wish, we can change that by setting e.g. `which = 'rows'`.\n\nNow, we may also want to see the `hire_data` in a sensible format.\nFor example, in this dirty data set, Jason Bourne was hired on `39690`.\nLuckily, our `janitor` can make sense of it all.\n\n```{r}\nxl_file %>% \n  mutate(hire_date = excel_numeric_to_date(hire_date))\n```\n\n## Rounding \n\nTo my ~~surprise~~ shock, R uses some unexpected rounding rule.\nIn my world, whenever a number ends in `.5`, standard rounding would round up.\nApparently, R uses something called *banker's rounding* that in these cases \nrounds towards the next *even* number.\nTake a look.\n\n```{r}\nround(seq(0.5, 4.5, 1))\n```\n\nI would expect that the rounded vector contains the integers from one to five.\nThankfully, `janitor` offers a convenient rounding function.\n\n```{r}\nround_half_up(seq(0.5, 4.5, 1))\n```\n\nOk, so that gives us a new function for rounding towards integers.\nBut what is really convenient is that `janitor` can `round_to_fraction`s.\n\n```{r}\nround_to_fraction(seq(0.5, 2.0, 0.13), denominator = 4)\n```\n\nHere, I rounded the numbers to the next quarters (`denominator = 4`) but of course\nany fraction is possible. \nYou can now live the dream of rounding towards arbitrary fractions.\n\n\n## Find matches in multiple characteristics\n\nIn my opinion, the `get_dupes()` function is really powerful.\nIt allows us to find \"similar\" observations in a data set based on certain characteristics.\nFor example, the `starwars` data set from `dplyr`  contains a lot of information \non characters from the Star Wars movies.\nPossibly, we want to find out which characters are similar w.r.t. to certain traits.\n\n```{r}\nstarwars %>% \n  get_dupes(eye_color, hair_color, skin_color, sex, homeworld) %>% \n  select(1:8)\n```\n\nSo, Luke and Anakin Skywalker are similar to one another. \nWho would have thought that.\nSadly, I don't enough about Star Wars to know whether the other matches are similarly \n\"surprising\".\nIn any case, the point here is that we can easily find matches according to \narbitrarily many characteristics.\nConveniently, these characteristics are the first columns of the new output and \nwe get a `dupe_count`.\n\n\nAlright, this concludes our little showcase.\nIn the `janitor` package, there is another set of `tabyl()` functions. \nThese are meant to improve base R's `table()` functions. \nSince I rarely use that function I did not include it but if you use `table()` frequently, \nthen you should definitely [check out tabyl()](http://sfirke.github.io/janitor/articles/tabyls.html).\n"},"formats":{"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":true,"echo":true,"output":true,"warning":false,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"message":false,"collapse":false,"engine":"knitr"},"render":{"keep-tex":false,"keep-yaml":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","filters":["code-filename"],"toc":true,"toc-depth":3,"include-after-body":["../../footer.html"],"output-file":"07_janitor_showcase.html"},"language":{},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.0.35","editor":"source","theme":{"light":"../../theme.scss"},"title-block-banner":false,"author":"Albert Rapp","page-layout":"article","comments":{"utterances":{"repo":"AlbertRapp/blogComments"}},"title":"Showcasing the janitor package","date":"2022-01-12","categories":[],"description":"I demonstrate a couple of functions from the janitor package I find quite useful","editor_options":{"chunk_output_type":"console"}},"extensions":{"book":{"multiFile":true}}}}}