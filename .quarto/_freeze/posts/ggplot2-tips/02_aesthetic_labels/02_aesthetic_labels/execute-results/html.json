{
  "hash": "5b6e25a7c77502dec6f4d95fc2e4a541",
  "result": {
    "markdown": "---\ntitle: 'ggplot tips: Assigning Labels to an Aesthetic'\ndate: '2021-08-19'\ncategories: [\"Visualization\"]\ndescription: 'We talk about how to easily create labels for an aesthetic.'\nexecute: \n  message: false\n  warning: false\n  collapse: false\neditor_options: \n  chunk_output_type: console\n---\n\n::: {.cell}\n\n:::\n\n\nThis blog post is part of a series I am creating where I collect tips I found useful when I first learned to work with `ggplot2`.\nAll posts which are part of this series can be found [here](https://albert-rapp.de/ggplot-series.html).\nIn this post I want to deal with how to manually or automatically create labels for some aesthetic.\n\n## Manually Assigning Labels\nAssigning labels by hand, e.g. via `col = \"some label\"`, can be a great idea in some instances.\nFor example, when you use two different smoothing methods, a hand-written label to differentiate between the two methods helps a lot.\nFor instance, take a look the relationship between city mileage `cty` and highway mileage `hwy` of cars in the `mpg` data set from the `ggplot2` package.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nggplot(data = mpg, aes(hwy, cty)) +\n  geom_jitter(alpha = 0.5)\n```\n\n::: {.cell-output-display}\n![](02_aesthetic_labels_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\nIf one suspects a linear relationship between those two variables, one might want to use `geom_smooth(method = 'lm')` to check that hypothesis by drawing a straight line through the points.\nSimilarly, one may be inclined  to see what `geom_smooth()` would return if a linear model is not enforced.\nAdding both smoothing methods to the plot (and removing the confidence bands) yields:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = mpg, aes(hwy, cty)) +\n  geom_jitter(alpha = 0.5) +\n  geom_smooth(se = F, size = 1.5) +\n  geom_smooth(method = 'lm', se = F, size = 1.5)\n```\n\n::: {.cell-output-display}\n![](02_aesthetic_labels_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n\nObviously, differently colored lines should be used here to differentiate between the two smoothing methods.\nWe have two approaches to do this. \nEither, we can manually assign a color (without using `aes()`):\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = mpg, aes(hwy, cty)) +\n  geom_jitter(alpha = 0.5) +\n  geom_smooth(se = F, size = 1.5, col = 'red') +\n  geom_smooth(method = 'lm', se = F, size = 1.5, col = 'blue')\n```\n\n::: {.cell-output-display}\n![](02_aesthetic_labels_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n\nOr we can use `aes()` and assign labels instead and let `ggplot2` handle the colors on its own.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = mpg, aes(hwy, cty)) +\n  geom_jitter(alpha = 0.5) +\n  geom_smooth(aes(col = 'auto'), se = F, size = 1.5) +\n  geom_smooth(method = 'lm', aes(col = 'lm'), se = F, size = 1.5) +\n  labs(col = 'Smoothing')\n```\n\n::: {.cell-output-display}\n![](02_aesthetic_labels_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\nPersonally, I prefer the latter approach because it has a couple of small advantages\n\n* A legend is automatically generated with the corresponding labels such that even without looking at the code it becomes more obvious how each line was generated. \nAlso, creating labels for an aesthetic is kind of the point of this post.\n* I do not have to bother about the specific color names. For me, this is something that could take up a lot of time if I want to change the appearance of the plot later on because I might spend way too much time on finding colors that \"work\" together. \nHere, if I want to change the colors, I could simply use a Brewer color palette and hope that the creators of that palette had good reasons to arrange the palette the way they did.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = mpg, aes(hwy, cty)) +\n  geom_jitter(alpha = 0.5) +\n  geom_smooth(aes(col = 'auto'), se = F, size = 1.5) +\n  geom_smooth(method = 'lm', aes(col = 'lm'), se = F, size = 1.5) +\n  labs(col = 'Smoothing') +\n  scale_color_brewer(palette = 'Set1')\n```\n\n::: {.cell-output-display}\n![](02_aesthetic_labels_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n## Automatically Assigning Labels via Pivoting\n\nSometimes, manually coloring aspects of your data can also be a bad idea.\nEspecially, if you find yourself using the exact same `geom_*` multiple times on different variables of a data set, you may want to think about using a different approach.\nOne such approach can be to rearrange the data first.\nFor example, take a look at the following two time series that were simulated and collected in a tibble as follows:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(123)\nx1 <- rnorm(10)\nx2 <- rnorm(10)\ntib <- tibble(\n  t = seq_along(x1),\n  ts1 = cumsum(x1),\n  ts2 = cumsum(x2)\n)\ntib\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 10 Ã— 3\n       t    ts1   ts2\n   <int>  <dbl> <dbl>\n 1     1 -0.560  1.22\n 2     2 -0.791  1.58\n 3     3  0.768  1.98\n 4     4  0.839  2.10\n 5     5  0.968  1.54\n 6     6  2.68   3.33\n 7     7  3.14   3.82\n 8     8  1.88   1.86\n 9     9  1.19   2.56\n10    10  0.746  2.09\n```\n:::\n:::\n\n\nNow, it is possible to plot both times series using `geom_line()` and use different colors for each line.\nTo do so, one might be tempted (as I often was when I first learned `ggplot2`) to write code similar to the one we wrote earlier:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntib %>% \n  ggplot(aes(x = t)) +\n  geom_line(aes(y = ts1, col = \"Time series 1\")) +\n  geom_line(aes(y = ts2, col = \"Time series 2\"))\n```\n\n::: {.cell-output-display}\n![](02_aesthetic_labels_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\nHere, we basically used `geom_line()` twice for more or less the same plot but with only one aesthetic slightly changed. \nHowever, this may not be the best approach.\nThis is especially true if we were to do this for, say, 100 time series as it would involve a lot of code duplication.\n\nInstead, let's try to rearrange the data via `pivot_longer()` before even beginning to plot anything[^pivot-longer].\nThis way, we might even plot way more than 2 time series with only a single `geom_line()`:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(123)\n# Create multiple time series\ntib <- map_dfc(1:6, ~cumsum(rnorm(10))) %>% \n  rename_with(~glue::glue(\"label{1:6}\")) %>% \n  bind_cols(t = 1:10, .)\n\n# Pivot and plot\ntib %>% \n  pivot_longer(cols = -1, names_to = \"ts\") %>% \n  ggplot(aes(t, value, col = ts)) +\n  geom_line()\n```\n\n::: {.cell-output-display}\n![](02_aesthetic_labels_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\nAs you just saw, it is also possible to, if necessary, relabel the column names in bulk before rearranging the data in order to label the aesthetic the way we want.\n\n## Same Procedure, Different Aesthetic\n\nFor the sake of an additional example, let us use the same ideas but with `geom_boxplot()` instead of `geom_line()`.\nTherefore, we will generate a couple of \"data sets\" and plot a box plot for each one:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(123)\nmap_dfc(1:6, rnorm, n = 100) %>% \n  rename_with(~(1:6)) %>%\n  pivot_longer(cols = everything(), names_to = \"ds\") %>% \n  ggplot(aes(col = ds, y = value)) +\n  geom_boxplot()\n```\n\n::: {.cell-output-display}\n![](02_aesthetic_labels_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\nHere, I have used `col` again but as I have recently come to realize, using `fill` instead of `col` creates the \"prettier\" box plots so let's use that instead.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(123)\nmap_dfc(1:6, rnorm, n = 100) %>% \n  rename_with(~(1:6)) %>%\n  pivot_longer(cols = everything(), names_to = \"ds\") %>% \n  ggplot(aes(fill = ds, y = value)) +\n  geom_boxplot()\n```\n\n::: {.cell-output-display}\n![](02_aesthetic_labels_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\nSo, as you just witnessed, what I have described so far does not only work with the color aesthetic.\nIn fact, we can pretty much use the same approaches for all other aesthetics.\n\nThus, we have seen how to easily create labels for an aesthetic of our choice by either manually assigning labels or rearranging the data first in order to use the previous column names to assign labels automatically.\nLet me know what you think in the comments or if you liked this post, simply hit the applause button below.\n\n[^pivot-longer]: I am not describing how `pivot_longer()` works in detail here because I want to keep this post short by only \"connecting the dots\". If you are unfamiliar with pivoting, you may check out the [tidy data chapter](https://yards.albert-rapp.de/dataWrangling.html#tidy-data) from my YARDS lecture notes which was of course inspired by the infamous [R for Data Science book](https://r4ds.had.co.nz/). For an animation that demonstrates what `pivot_longer()` and `pivot_wider()` do, see [gadenbuie/tidyexplain on GitHub](https://github.com/gadenbuie/tidyexplain/blob/master/images/tidyr-spread-gather.gif).\n",
    "supporting": [
      "02_aesthetic_labels_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}